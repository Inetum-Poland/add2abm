name: Lint

on:
  push:
  pull_request:

jobs:
  shellcheck:
    name: ShellCheck (lint)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Run ShellCheck
        uses: ludeeus/action-shellcheck@2.0.0
        with:
          scandir: .
        env:
          # Treat scripts as bash for better compatibility with zsh
          SHELLCHECK_OPTS: -x

  shfmt:
    name: shfmt (format check)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Install shfmt
        run: |
          curl -sSLo /usr/local/bin/shfmt \
            https://github.com/mvdan/sh/releases/download/v3.12.0/shfmt_v3.12.0_linux_amd64
          chmod +x /usr/local/bin/shfmt

      - name: Run shfmt (check only)
        run: |
          shfmt -d -i 2 -ci .
